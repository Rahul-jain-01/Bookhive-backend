"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.request = void 0;
const tslib_1 = require("tslib");
const axios_1 = tslib_1.__importDefault(require("axios"));
const TokenError_1 = require("../errors/TokenError");
const NotFound_1 = require("../errors/NotFound");
function request(client, request) {
    return new Promise((resolve, reject) => {
        const config = request.method === "GET"
            ? { method: request.method, url: request.url }
            : { method: request.method, url: request.url, data: request.body };
        client
            .request(config)
            .then((res) => {
            resolve(res.data);
        })
            .catch((err) => {
            var _a, _b, _c, _d;
            if (!axios_1.default.isAxiosError(err)) {
                reject(err);
            }
            if (((_a = err.response) === null || _a === void 0 ? void 0 : _a.status) === 401) {
                reject(new TokenError_1.TokenError(err.response.data.message));
            }
            if (((_b = err.response) === null || _b === void 0 ? void 0 : _b.status) === 404) {
                reject(new NotFound_1.NotFoundError(err.response.data.message));
            }
            reject(new Error((_d = (_c = err.response) === null || _c === void 0 ? void 0 : _c.data.message) !== null && _d !== void 0 ? _d : "Unknown API Error"));
        });
    });
}
exports.request = request;
